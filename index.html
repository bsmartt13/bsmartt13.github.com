
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>SmarttBits</title>
  <meta name="author" content="Bill Smartt">

  
  <meta name="description" content="Shortly after the September 11, 2001 terrorist attacks, the US government passed the PATRIOT act and told us it was needed to keep us safer from &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://bsmartt13.github.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="SmarttBits" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-27769868-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">SmarttBits</a></h1>
  
    <h2>Better living through hexadecimal.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:bsmartt13.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/13/what-hackers-need-to-know-about-the-patriot-act/">What Hackers Need to Know About the Patriot Act</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-13T07:25:00-08:00" pubdate data-updated="true">Jan 13<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/01/13/what-hackers-need-to-know-about-the-patriot-act/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Shortly after the September 11, 2001 terrorist attacks, the US government passed the PATRIOT act and told us it was needed to keep us safer from terrorism.  PATRIOT stands for &#8220;Providing Appropriate Tools Required (to) Intercept (and) Obstruct Terrorism&#8221;. After the attacks was a very vulnerable time for our population, and Bush was able to use our fear against us to pass the bill.  I find it depressingly ironic that the bill was named &#8220;Patriot Act&#8221; yet was mainly composed of laws restricting our freedom, rather than advancing or even preserving the state of national security like it&#8217;s name implies.  Provisions changed the law surrounding computer crimes and hacking.  </div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/01/13/what-hackers-need-to-know-about-the-patriot-act/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/12/ability-ftp-2-dot-34-stack-based-buffer-overflow/">Ability FTP 2.34 Stack-based Buffer Overflow</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-12T13:30:00-08:00" pubdate data-updated="true">Jan 12<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/01/12/ability-ftp-2-dot-34-stack-based-buffer-overflow/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Assessing the Vulnerability</h3>

<p>Let&#8217;s try exploiting a known vulnerability in Ability FTP 2.34.  This is a File Transfer Protocol (FTP) Server program made by code-crafters.com.  Let&#8217;s take a look at the cve (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1626).  Here&#8217;s the description of the vulnerability in the software.</p>

<blockquote><p>Buffer overflow in Ability Server 2.34, and possibly other versions, allows remote attackers to execute arbitrary code via a long STOR command.</p><footer><strong>CVE-2004-1626</strong> <cite><a href='http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1626'>cve.mitre.org/cgi-bin/&hellip;</a></cite></footer></blockquote>


<p>This is an extremely accurate CVE.  Most CVE&#8217;s do not contain specifics on how the attack works, just that one exists.  Here they even tell us what command we need to fuzz.
Open up a windows XP box.  For this example I will be using Win XP Professional version 2002 Service Pack 3.  Unless you are comfortable computing the offsets and other things yourself, you need this version.
Open up Ability FTP 2.34.  You can close the initial screen that pops up to reveal the main window.  Activate the FTP server.  You should now have something like this:</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/01/12/ability-ftp-2-dot-34-stack-based-buffer-overflow/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/08/counting-bits-set-to-1/">Counting Bits Set to 1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-08T07:02:00-08:00" pubdate data-updated="true">Jan 8<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/01/08/counting-bits-set-to-1/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Counting bits</h3>

<p>Determining the number of bits set to 1 in a particular value is an interesting problem, commonly referred to as a <em>population count</em>, and often referred to in assembly language simply as <em>pop</em>.  My favorite approach to this problem, and the way it is often implemented in cpu hardware is a recursive approach, and is almost like the reverse of a binary search in the way it accomplishes counting the bits set to 1 in a register value.</p>

<p>Suppose that our registers are n-bit registers.  Divide the problem into two halves, and we now need to count the number of one bits in two n/2 bit values.  We continue onto four n/4 bit values, eight n/8 bit values, etc. until the number of bits in each value we are counting is two, a trivially easy problem.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/01/08/counting-bits-set-to-1/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/05/reversing-bits-and-bytes/">Reversing Bits and Bytes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-05T13:48:00-08:00" pubdate data-updated="true">Jan 5<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/01/05/reversing-bits-and-bytes/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Introduction</h3>

<p>Bits and Bytes need to be reversed quite often.  Some computers store data in a little-endian format and some in a big-endian format.  In order for communication between these two hosts to work, these conversions must be done with extreme precision.  When coding at a high level, such as using the Socket object in a Java program, one doesn&#8217;t need to worry about these issues.  As the data flows down the OSI model from the Application layer to the Physical layer, our operating system kernel will do all the endian conversions as necessary.</p>

<p>But this may not always be the case.  And even when it is, having a good understanding of whats going on under the hood can be very beneficial for debugging.  A few examples of which you may be interested in endianness and the flipping of bits/bytes are:
- Raw Sockets in C
- Writing exploits
- Cryptography
- Assembly Language</p>

<h3>Understanding the difference</h3>

<p>Distinguishing between flipping bits and flipping bytes is a must for hackers.  Let&#8217;s take the example <code>0xdeadbeef</code>.  For the sake of simplicity, we&#8217;ll assume an atomic variable size of 2 bytes or 16 bits.  This is standard on Linux kernel 2.6.39.* and Windows XP SP3.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/01/05/reversing-bits-and-bytes/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/01/13/what-hackers-need-to-know-about-the-patriot-act/">What hackers need to know about the Patriot Act</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/12/ability-ftp-2-dot-34-stack-based-buffer-overflow/">Ability FTP 2.34 Stack-based Buffer Overflow</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/08/counting-bits-set-to-1/">Counting Bits Set to 1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/05/reversing-bits-and-bytes/">Reversing Bits and Bytes</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/bsmartt13">@bsmartt13</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'bsmartt13',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("bsmartt13", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/bsmartt13" class="twitter-follow-button" data-show-count="false">Follow @bsmartt13</a>
  
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Bill Smartt -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'smarttbits';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
